# 受入条件 (Acceptance Criteria)
## Multi-Agent Claude Code Development System (MACCDS)

## 1. 概要

本文書では、AI Multi-Agent Claude Code Development System（MACCDS）の受入条件を定義する。各機能要件、非機能要件、およびユーザーストーリーに対して、明確で測定可能な受入基準を示す。

## 2. 機能要件の受入条件

### 2.1 エージェント管理機能

#### AC-001: エージェント起動・停止機能 (FR-001)
**Given** システムが正しくセットアップされている  
**When** `bash start-agents.sh`を実行する  
**Then** 以下の条件を満たす:
- [ ] 10個以上のClaude Codeインスタンスが起動する
- [ ] 各エージェントが30秒以内に稼働状態になる
- [ ] tmuxセッション「ai-multi-agent」が作成される
- [ ] Boss/POエージェントが対話待機状態になる
- [ ] エラーが発生した場合、明確なエラーメッセージが表示される

**Given** システムが稼働中である  
**When** `bash stop-agents.sh`を実行する  
**Then** 以下の条件を満たす:
- [ ] 全てのエージェントが安全に停止する
- [ ] 実行中の作業状態が保存される
- [ ] tmuxセッションが適切に終了される
- [ ] 「AI Multi-Agent system stopped.」メッセージが表示される

#### AC-002: ペルソナ設定機能 (FR-002)
**Given** agents/[role]/CLAUDE.mdファイルが存在する  
**When** エージェントを起動する  
**Then** 以下の条件を満たす:
- [ ] 各エージェントが指定されたペルソナで動作する
- [ ] ペルソナファイルの内容が正しく読み込まれる
- [ ] エージェントの応答がペルソナに一致する
- [ ] ペルソナファイルの変更が次回起動時に反映される

#### AC-003: エージェント状態監視機能 (FR-003)
**Given** エージェントが稼働中である  
**When** 状態監視を実行する  
**Then** 以下の条件を満たす:
- [ ] 各エージェントの状態（稼働中/待機中/エラー）が確認できる
- [ ] tmuxペインの状態が正確に反映される
- [ ] エージェントの応答性が10秒以内にチェックされる
- [ ] 状態変化が即座に検出される

### 2.2 タスク管理機能

#### AC-010: タスク分解機能 (FR-010)
**Given** 開発要求が明確化されている  
**When** PMエージェントがタスク分解を依頼する  
**Then** 以下の条件を満たす:
- [ ] 各専門エージェントがタスクを詳細分解する
- [ ] 全てのタスクが13ポイント以下に分割される
- [ ] 見積もりが各タスクに付与される
- [ ] タスク間の依存関係が明確化される
- [ ] 分解結果が5秒以内に回答される

#### AC-011: タスク割り当て機能 (FR-011)
**Given** タスクが分解済みである  
**When** PMエージェントがタスクを割り当てる  
**Then** 以下の条件を満たす:
- [ ] 各エージェントのスキルセットとタスクが適切にマッチしている
- [ ] 優先順位に基づいて割り当てられる
- [ ] 依存関係が考慮されている
- [ ] 全てのタスクが割り当て済みになる
- [ ] 各エージェントが割り当てを確認する

#### AC-012: 進捗追跡機能 (FR-012)
**Given** タスクが割り当て済みである  
**When** 作業が進行中である  
**Then** 以下の条件を満たす:
- [ ] タスクの状態が正確に管理される
- [ ] 進捗状況が可視化される
- [ ] ボトルネックが自動検出される
- [ ] 進捗レポートが生成される
- [ ] 遅延が発生した場合、アラートが出る

### 2.3 通信・協調機能

#### AC-020: エージェント間通信機能 (FR-020)
**Given** 複数のエージェントが稼働中である  
**When** エージェント間でメッセージを送信する  
**Then** 以下の条件を満たす:
- [ ] メッセージが1秒以内に配信される
- [ ] 送信確認が取れる
- [ ] メッセージの内容が正確に伝達される
- [ ] 共有ディレクトリ経由の非同期通信が機能する
- [ ] 通信ログが記録される

#### AC-021: 人間とのインターフェース機能 (FR-021)
**Given** Boss/POエージェントが稼働中である  
**When** 人間が要求を入力する  
**Then** 以下の条件を満たす:
- [ ] 自然言語での入力が可能
- [ ] 要求が適切に分析・整理される
- [ ] 確認・提案が分かりやすく返される
- [ ] 合意形成までの対話が継続される
- [ ] 最終的な開発指示が適切に伝達される

### 2.4 開発支援機能

#### AC-030: Git統合機能 (FR-030)
**Given** Gitリポジトリが存在する  
**When** 並列開発を開始する  
**Then** 以下の条件を満たす:
- [ ] git worktreeが正しく作成される
- [ ] 各エージェントがタスク毎の独立したブランチで作業する
- [ ] コンフリクトが発生しない
- [ ] ブランチの管理が適切に行われる

#### AC-031: GitHub連携機能 (FR-031)
**Given** GitHub MCPが設定済みである  
**When** 作業が完了する  
**Then** 以下の条件を満たす:
- [ ] Pull Requestが自動作成される
- [ ] レビューコメントが適切に付与される
- [ ] マージプロセスが正常に動作する
- [ ] GitHub API制限内で動作する

#### AC-032: テスト自動実行機能 (FR-032)
**Given** テストコードが存在する  
**When** 実装が完了する  
**Then** 以下の条件を満たす:
- [ ] 自動的にテストが実行される
- [ ] テスト結果が適切に収集される
- [ ] カバレッジが測定される
- [ ] 失敗したテストが明確に報告される

### 2.5 エラー処理・復旧機能

#### AC-040: エラー検出機能 (FR-040)
**Given** システムが稼働中である  
**When** エラーが発生する  
**Then** 以下の条件を満たす:
- [ ] エラーが即座に検出される
- [ ] エラー情報が詳細に記録される
- [ ] 適切なアラートが発生する
- [ ] エラーの影響範囲が特定される

#### AC-041: 自動復旧機能 (FR-041)
**Given** エラーが検出されている  
**When** 復旧処理が実行される  
**Then** 以下の条件を満たす:
- [ ] エージェントが自動的に再起動される
- [ ] タスク状態が正常に復元される
- [ ] 5分以内にシステムが正常状態に復旧する
- [ ] 復旧プロセスが記録される

## 3. 非機能要件の受入条件

### 3.1 性能要件

#### AC-100: 応答時間 (PF-001 to PF-004)
**Given** システムが正常稼働中である  
**When** 各操作を実行する  
**Then** 以下の応答時間を満たす:
- [ ] タスク割り当て処理：5秒以内
- [ ] エージェント間通信：1秒以内
- [ ] エージェント起動時間：30秒以内
- [ ] 状態監視の更新間隔：10秒以内

#### AC-101: スループット (PF-010 to PF-012)
**Given** システムが最大負荷で稼働中である  
**When** 性能測定を実行する  
**Then** 以下の性能を満たす:
- [ ] 最低10エージェントの同時実行
- [ ] 単独実行比6倍以上の生産性
- [ ] 1日100タスク以上の処理能力

### 3.2 信頼性要件

#### AC-110: 可用性 (RL-001 to RL-003)
**Given** システムが運用中である  
**When** 長期間の稼働テストを実行する  
**Then** 以下の可用性を満たす:
- [ ] システム稼働率：99%以上
- [ ] エージェント個別稼働率：95%以上
- [ ] 障害からの復旧時間：5分以内

#### AC-111: 耐障害性 (RL-010 to RL-012)
**Given** システムが稼働中である  
**When** 障害を意図的に発生させる  
**Then** 以下の耐障害性を満たす:
- [ ] 単一エージェント障害でもシステム継続
- [ ] データ消失が発生しない
- [ ] 部分障害からの自動復旧

### 3.3 使いやすさ要件

#### AC-120: 操作性 (US-001 to US-003)
**Given** 新規ユーザーがシステムを利用する  
**When** 基本操作を学習する  
**Then** 以下の操作性を満たす:
- [ ] 簡単なコマンドでの起動・停止
- [ ] 直感的な設定変更
- [ ] 分かりやすい進捗表示

#### AC-121: 学習容易性 (US-010 to US-012)
**Given** 新規ユーザーがシステムを学習する  
**When** チュートリアルを実行する  
**Then** 以下の学習容易性を満たす:
- [ ] 基本操作を30分で習得
- [ ] 新規エージェント追加を1時間で実現
- [ ] 充実したドキュメント

### 3.4 保守性要件

#### AC-130: 変更容易性 (MT-001 to MT-003)
**Given** システムの構成変更が必要である  
**When** 設定を変更する  
**Then** 以下の変更容易性を満たす:
- [ ] 設定ファイル編集のみで構成変更
- [ ] ペルソナファイル編集のみでペルソナ変更
- [ ] 既存機能への影響最小化

#### AC-131: 診断可能性 (MT-010 to MT-012)
**Given** システムで問題が発生している  
**When** 診断を実行する  
**Then** 以下の診断可能性を満たす:
- [ ] 詳細ログが出力される
- [ ] エラー原因が特定可能
- [ ] 性能メトリクスが測定される

### 3.5 移植性要件

#### AC-140: 環境依存性 (PT-001 to PT-003)
**Given** 対応環境が準備されている  
**When** システムをインストールする  
**Then** 以下の環境で動作する:
- [ ] macOS環境での動作
- [ ] Linux環境での動作
- [ ] 16GB RAM、マルチコアCPUでの安定動作

#### AC-141: 再利用性 (PT-010 to PT-012)
**Given** 異なるプロジェクトでシステムを利用する  
**When** システムを導入する  
**Then** 以下の再利用性を満たす:
- [ ] 任意のプロジェクトでの利用可能
- [ ] プログラミング言語非依存
- [ ] フレームワーク非依存

### 3.6 セキュリティ要件

#### AC-150: 認証・認可 (SC-001 to SC-003)
**Given** システムがセキュリティ要件を満たす必要がある  
**When** セキュリティテストを実行する  
**Then** 以下の認証・認可を満たす:
- [ ] Claude Code CLI認証の適切な利用
- [ ] GitHub MCP認証の適切な利用
- [ ] 機密情報の安全な管理

#### AC-151: データ保護 (SC-010 to SC-012)
**Given** 機密データが扱われる  
**When** データ保護テストを実行する  
**Then** 以下のデータ保護を満たす:
- [ ] 作業データの暗号化
- [ ] ログの安全な管理
- [ ] 外部通信の暗号化

## 4. ユーザーストーリーの受入条件

### Epic 1: システム環境構築

#### AC-200: 簡単なセットアップ (US-001)
**Given** 開発者が新しい環境でシステムを導入する  
**When** セットアップ手順を実行する  
**Then** 以下の条件を満たす:
- [ ] git cloneと2-3のコマンドでセットアップ完了
- [ ] 30分以内にシステムが利用可能
- [ ] エラー時に明確なメッセージが表示される
- [ ] ドキュメントに従って問題なく完了する

#### AC-201: 設定のカスタマイズ (US-002)
**Given** プロジェクト固有の要件がある  
**When** エージェント構成をカスタマイズする  
**Then** 以下の条件を満たす:
- [ ] YAMLファイルの編集で構成変更可能
- [ ] エージェント数とスキルセットを柔軟に設定
- [ ] 設定変更が即座に反映される
- [ ] 設定エラー時に適切な警告が表示される

### Epic 2: 要求管理

#### AC-210: 自然言語での要求入力 (US-003)
**Given** プロダクトオーナーが新機能を要求する  
**When** 自然言語で要求を入力する  
**Then** 以下の条件を満たす:
- [ ] 日本語での入力が正常に処理される
- [ ] 曖昧な要求に対して適切な質問が返される
- [ ] 要求の理解度が確認できる
- [ ] 技術的な詳細を知らなくても利用可能

#### AC-211: 要求の段階的明確化 (US-004)
**Given** 最初の要求が曖昧である  
**When** 対話的に要求を明確化する  
**Then** 以下の条件を満たす:
- [ ] システムが不明点を的確に質問する
- [ ] 段階的に詳細を決定できる
- [ ] いつでも要求を変更・追加可能
- [ ] 最終的に明確な仕様が確定する

### Epic 3: 開発プロセス

#### AC-220: 並列開発の自動実行 (US-005)
**Given** 開発タスクが定義されている  
**When** 並列開発を実行する  
**Then** 以下の条件を満たす:
- [ ] 10個以上のエージェントが同時に作業
- [ ] 作業の重複や競合が発生しない
- [ ] 単独開発比6倍以上の速度向上
- [ ] 品質が維持される

#### AC-221: 自動コードレビュー (US-006)
**Given** コードが実装完了している  
**When** レビュープロセスを実行する  
**Then** 以下の条件を満たす:
- [ ] 全てのコードが自動的にレビューされる
- [ ] レビューコメントが適切で有用
- [ ] 重大な問題は人間に報告される
- [ ] レビュー品質が一定水準以上

### Epic 4: 監視・制御

#### AC-230: リアルタイム進捗監視 (US-007)
**Given** 開発作業が進行中である  
**When** 進捗を監視する  
**Then** 以下の条件を満たす:
- [ ] tmux画面で全エージェントの状況を確認可能
- [ ] 進捗の遅れやエラーが即座に分かる
- [ ] 全体の完了見込み時間が表示される
- [ ] 適切なタイミングで状況が更新される

#### AC-231: 簡単な停止・再開 (US-008)
**Given** システムが稼働中である  
**When** 停止・再開操作を実行する  
**Then** 以下の条件を満たす:
- [ ] 1つのコマンドで安全に停止
- [ ] 作業状態が適切に保存される
- [ ] 再開時に前回の続きから開始される
- [ ] データの整合性が保たれる

### Epic 5: エラー処理

#### AC-240: 自動エラー回復 (US-009)
**Given** システムでエラーが発生している  
**When** 自動回復プロセスを実行する  
**Then** 以下の条件を満たす:
- [ ] エージェントのクラッシュから自動復旧
- [ ] 作業データの消失を防止
- [ ] 5分以内にシステムが正常状態に復旧
- [ ] 復旧プロセスが記録される

#### AC-241: 分かりやすいエラー報告 (US-010)
**Given** エラーが発生している  
**When** エラー情報を確認する  
**Then** 以下の条件を満たす:
- [ ] エラーの原因が明確に説明される
- [ ] 解決方法が具体的に提示される
- [ ] 人間の介入が必要な場合が分かる
- [ ] エラーレベルが適切に分類される

## 5. 統合受入条件

### AC-300: エンドツーエンドシナリオ
**Given** システムが完全にセットアップされている  
**When** 完全な開発サイクルを実行する  
**Then** 以下のシナリオが成功する:

1. **システム初期化**
   - [ ] `bash start-agents.sh`でシステム起動
   - [ ] 全エージェントが正常稼働

2. **要求定義から実装まで**
   - [ ] 人間がBoss/POエージェントに要求を伝達
   - [ ] 要求が適切に分析・合意形成
   - [ ] タスクが分解・割り当て
   - [ ] 並列開発が実行
   - [ ] コードレビューが完了
   - [ ] テストが成功

3. **品質確認**
   - [ ] 全ての機能が期待通り動作
   - [ ] 非機能要件を満たす
   - [ ] エラーが適切に処理される

4. **システム停止**
   - [ ] `bash stop-agents.sh`で安全に停止
   - [ ] 作業状態が保存される

### AC-301: 長期運用テスト
**Given** システムが本格運用されている  
**When** 1週間の連続運用テストを実行する  
**Then** 以下の条件を満たす:
- [ ] システム稼働率99%以上を維持
- [ ] メモリリークが発生しない
- [ ] 性能劣化が発生しない
- [ ] データ整合性が保たれる

## 6. 受入テスト計画

### 6.1 テスト環境
- **OS**: macOS 14+, Ubuntu 20.04+
- **ハードウェア**: 16GB RAM以上、4コア以上CPU
- **ソフトウェア**: Claude Code CLI, tmux, Git, GitHub MCP

### 6.2 テスト手順
1. 機能テスト（各受入条件を個別に検証）
2. 統合テスト（エンドツーエンドシナリオ）
3. 性能テスト（負荷テスト、長期運用テスト）
4. ユーザビリティテスト（実際のユーザーによる評価）

### 6.3 合格基準
- 全ての受入条件（AC-001 to AC-301）が満たされること
- 重大な障害が発生しないこと
- ユーザビリティテストで80%以上の満足度

---

**承認**  
本受入条件は、MACCDS の品質基準および完成度の判断基準として使用される。

作成日: 2025-01-07  
バージョン: 1.0.0